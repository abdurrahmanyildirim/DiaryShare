@model DiaryShare.MVCWebUI.ViewModels.ProfileViewModel


@{
    ViewBag.Title = "Profile";
    string btnStyle;
    string statu;
    var colorOfBtn = 1;
    if (Model.IsFollower && !Model.IsOwnProfile)
    {
        btnStyle = "color:white;background-color:red";
        statu = "Takipten Çık";

    }
    else
    {
        btnStyle = null;
        statu = "Takip Et";
        colorOfBtn = 2;
    }
}

<div class="col-md-offset-1 col-md-8">
    <div class="panel panel-info">
        <div class="panel-body">
            <div>
                <div class="col-md-1">
                    <img class="thumbnail pull-left" style="width:120px;height:120px;border-radius:60px; border:1px solid grey;margin-left:5px;margin-top:5px;" src="@Url.Content(Model.AccountInfo.ProfilPhotoPath)" alt="@Model.AccountInfo.FirstName-@Model.AccountInfo.LastName" />

                </div>
                <div class="col-md-7" style="margin-top:-15px;margin-left:80px">
                    <div>
                        <h3> @Model.AccountInfo.FirstName @Model.AccountInfo.LastName</h3>
                    </div>
                    <div>
                        <p> @Model.AccountInfo.PersonelInfo </p>
                    </div>
                    <br />
                </div>
            </div>
            <br />
            <div class="col-md-12">
                <small>@Model.AccountInfo.MemberDate.ToShortDateString() Tarihinde Katıldı.</small>

                @if (Model.IsOwnProfile)
                {
                    @Html.ActionLink("Hesap Ayarları", "ProfilSettings", "Profile", new { @class = "btn btn-info form-control" })
                }
                else
                {
                    //using (Ajax.BeginForm("ChangeToFollower", "Profile", new { id = Model.AccountInfo.AccountID }, new AjaxOptions() { HttpMethod = "POST", InsertionMode = InsertionMode.Replace, UpdateTargetId = "diaryList" }))
                    //{
                    <div id="followBtn" style="@btnStyle" class="btn btn-default form-control">@statu</div>
                    <input type="hidden" id="statusInfo" value="@colorOfBtn" />
                }
            </div>
            <br />

            <table class="table table-hover" style="margin-top:-20px;" id="diaryList">
                <thead>
                    <tr>
                        <th>Günlükler</th>
                    </tr>
                </thead>
                <tbody id="profileDiaries">
                    @if (Model.DiariesInfo.Count <= 0)
                    {
                        <tr>
                            <td>
                                <div class="alert alert-info">
                                    Henüz günlük paylaşımı yapılmadı.
                                </div>
                            </td>
                        </tr>
                    }
                    else
                    {
                        foreach (var item in Model.DiariesInfo)
                        {
                            <tr>
                                <td>
                                    <div>
                                        <img class="thumbnail pull-left" style="width:60px;height:60px;border-radius:30px; border:1px solid grey;margin-left:5px;margin-top:5px;" src="@Url.Content(Model.AccountInfo.ProfilPhotoPath)" alt="@Model.AccountInfo.FirstName-@Model.AccountInfo.LastName" />

                                    </div>
                                    <div style="margin-top:-15px;margin-left:80px">
                                        <a id="aHover" href="@Url.Action("Main","Profile",new { id=Model.AccountInfo.AccountID})" style="text-decoration:none;color:black">
                                            <div>
                                                <h3> @Model.AccountInfo.FirstName @Model.AccountInfo.LastName</h3>
                                            </div>
                                        </a>
                                        <div>
                                            <a style="text-decoration:none;color:black" href="@Url.Action("DiaryDetail","Home",new  { id=item.DiaryID})">
                                                <div>
                                                    <h4>@item.Title</h4>
                                                    <p> @item.DiaryContent</p>
                                                </div>
                                                <br />
                                            </a>
                                        </div>
                                        <br />
                                    </div>
                                    <small>@item.CreatedDate</small>
                                </td>
                            </tr>
                        }
                    }
                </tbody>
            </table>

        </div>
    </div>
</div>
<div class="col-md-3">
    @{Html.RenderAction("_TrendAccounts", "Home");}
</div>

@section scripts {

    <script>
        $(document).ready(function () {

            $("#followBtn").click(function () {
                if ($("#statusInfo").val() == 2) {
                    $('#statusInfo').attr('value', 1);
                    $("#followBtn").css({ "background-color": "red", "color": "white" });
                    $("#followBtn").html("Takipten Çık");
                } else {
                    $("#followBtn").css({ "background-color": "white", "color": "black" });
                    $("#followBtn").html("Takip Et");
                    $('#statusInfo').attr('value', 2);
                }

                $.ajax({
                    method: "post",
                    url: "/Profile/ChangeToFollower/" +@Model.AccountInfo.AccountID,
                    dataType: "json"
                })
            })
        })

    </script>

}
