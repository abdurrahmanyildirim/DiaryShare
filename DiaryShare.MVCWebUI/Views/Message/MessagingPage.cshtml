@model DiaryShare.MVCWebUI.ViewModels.MessagePageViewModel

@{
    ViewBag.Title = "MessagingPage";
}

<div class="col-md-3 col-md-offset-2" style="height:400px;overflow:auto;border:solid 1px black;padding:0 0 0 0;background-color:ButtonFace">
    <table class="table table-hover">
        @foreach (var item in Model.AccountsOfMessages)
        {
            <tr>
                <td class="messagingAccount">
                    <input id="accountInfo" type="hidden" value="@item.AccountID" />
                    <a class="ısClick" href="#" style="text-decoration:none;color:black" onclick="loadMessagingContent(@item.AccountID)">
                        @item.FirstName @item.LastName
                        @if (item.CountOfIsNotReadMessage > 0)
                        {
                            <span class="badge">@item.CountOfIsNotReadMessage</span>
                        }
                    </a>
                </td>
            </tr>
        }
    </table>
</div>
<div class="col-md-6" style="height:400px;border-top:solid 1px black;border-right:solid 1px black;border-bottom:solid 1px black;padding:0 0 0 0;background-color:ButtonFace">
    <div id="messagingContent" style="height:361px;overflow-y:auto">
        <h4 style="text-align:center">Bir mesaj seçiniz <span class="glyphicon glyphicon-send"></span> </h4>
    </div>
    <div id="messagePlace" style="height:39px;border-top:solid 1px black">
        <div class="col-md-8">
            <input type="text" class="form-control" />
        </div>
        <div class="col-md-4">
            <div class="btn btn-success form-control glyphicon glyphicon-send"></div>
        </div>
    </div>
</div>



@section scripts{

    <script>

        $(document).ready(function () {
            $(".ısClick").click(function () {
                $(".messagingAccount").css("background-color", "ButtonFace");
                $(this).parent().css("background-color", "white");
            })
        })

        function loadMessagingContent(id) {
            $("#messagingContent").html("");
            $.ajax({
                method: "Post",
                url: "/Message/RequestMessagingContent/" + id,
                dataType: "json",
                success: (function (response) {
                    $("#messagingContent").html("");
                    $.each(response, function (index, value) {
                        $("#messagingContent").append("<div class='" + value.MessagePosition + " alert alert-success' style='height:auto;' >" + value.MessageContent + "</div>");
                    });
                })
            })
        }

    </script>

}
